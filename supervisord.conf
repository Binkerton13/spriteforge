[supervisord]
nodaemon=true
user=app
logfile=/tmp/supervisord.log
pidfile=/tmp/supervisord.pid

[program:comfyui]
command=/bin/bash -c "source /opt/venv/bin/activate && cd /opt/comfyui && python main.py --listen 0.0.0.0 --port ${PORT:-8188} --cpu"
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=10

[program:filebrowser]
command=/bin/bash -c "source /opt/venv/bin/activate && export FILE_BROWSER_PORT=8080 && export WORKSPACE=/workspace && python /usr/local/bin/file_browser.py"
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=20

[program:pipeline_gui]
command=/bin/bash -c "source /opt/venv/bin/activate && export PIPELINE_GUI_PORT=${PIPELINE_GUI_PORT:-7860} && cd /workspace/pipeline && python /workspace/pipeline/api_server.py"
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=30
